@page "/counter"
@inherits MainLayout

@inject AuthenticationStateProvider AuthState
@attribute [Authorize(Policy = "read:agents")]


<PageTitle>Counter</PageTitle> 

<h1>Counter</h1>

<p role="status">Current count: @currentCount</p>
@foreach (var i in state.User.Claims!)
{
    <p>@i</p>
}
<button class="btn btn-primary" @onclick="IncrementCount">Click me</button>

@code {
    AuthenticationState state;
    
    private int currentCount = 0;

    protected override async Task OnInitializedAsync()
    {
        state = await AuthState.GetAuthenticationStateAsync();
        await base.OnInitializedAsync();
    }

    private void IncrementCount()
    {
        currentCount++;
    }

}