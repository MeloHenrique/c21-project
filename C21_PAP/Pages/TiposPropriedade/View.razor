@page "/tipos-propriedade"
@using C21_PAP.Models.TiposPropriedades
@using C21_PAP.ViewModels.TiposPropriedades
@inject ViewViewModel _viewViewModel
@inject AuthenticationStateProvider AuthState
@layout MainLayout

@attribute [Authorize(Policy = "read:property_types")]


<PageTitle>Tipos de Propriedade</PageTitle>

<AuthorizeView Policy="create:property_type">
    <MudButton Class="mb-2" Variant="Variant.Filled" Color="Color.Primary" DisableElevation="true" OnClick="@(_viewViewModel.CreateDialog)">Criar Tipo de Propriedade</MudButton>
</AuthorizeView>
<MudTable @ref="@_viewViewModel.table" ServerData="@(new Func<TableState, Task<TableData<TipoPropriedadeModel>>>(_viewViewModel.ServerReload))" Hover="true" Bordered="true" Dense="true" LoadingProgressColor="Color.Default" Breakpoint="Breakpoint.None" HorizontalScrollbar="true">
    <HeaderContent>
        <MudTh Style="text-align:start">Id</MudTh>
        <MudTh Style="text-align:center">Tipo de Propriedade</MudTh>
        <MudTh Style="text-align:center">Ativo</MudTh>
        <AuthorizeView Policy="edit:property_types">
            <MudTh Style="text-align:end"></MudTh>
        </AuthorizeView>
    </HeaderContent>
    <RowTemplate>
        <MudTd DataLabel="Id">@context._Id</MudTd>
        <MudTd DataLabel="Tipo de Propriedade">@context.Name</MudTd>
        <MudTd DataLabel="Ativo"><MudCheckBox Disabled="true" Checked="@context.Active" Color="Color.Secondary"></MudCheckBox></MudTd>
        <AuthorizeView Context="authContext" Policy="edit:property_types">
            <MudTd DataLabel=""><MudIconButton Icon="@Icons.Filled.Edit" OnClick="@(() => _viewViewModel.EditDialog(context))"></MudIconButton></MudTd>
        </AuthorizeView>
    </RowTemplate>
</MudTable>